{"version":3,"names":["WebSocketProvider","cov_3e866ljed","f","s","useWebSocketContext","WebSocketContext","_react","createContext","children","token","wsUrl","setWsUrl","useState","useEffect","protocol","window","location","b","host","process","env","NODE_ENV","connected","subscribe","unsubscribe","subscribeToChannel","sendChatMessage","client","_websocket","useWebSocket","url","autoConnect","onConnect","console","log","onDisconnect","contextValue","_jsxruntime","jsx","Fragment","Provider","value","context","useContext","Error"],"sources":["/Users/joshszep/code/therobotoverlord-mono/therobotoverlord-web/src/components/WebSocketProvider.tsx"],"sourcesContent":["/**\n * WebSocket Provider component for real-time updates.\n */\n\n'use client';\n\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useWebSocket, WebSocketClient } from '@/lib/websocket';\n\ninterface WebSocketContextType {\n  connected: boolean;\n  client: WebSocketClient | null;\n  subscribe: (eventType: string, handler: (data: any) => void) => void;\n  unsubscribe: (eventType: string, handler: (data: any) => void) => void;\n  subscribeToChannel: (channel: string) => void;\n  sendChatMessage: (message: string, conversationId?: string) => void;\n}\n\nconst WebSocketContext = createContext<WebSocketContextType | null>(null);\n\ninterface WebSocketProviderProps {\n  children: React.ReactNode;\n  token: string;\n}\n\nexport function WebSocketProvider({ children, token }: WebSocketProviderProps) {\n  const [wsUrl, setWsUrl] = useState<string>('');\n\n  useEffect(() => {\n    // Determine WebSocket URL based on environment\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const host = process.env.NODE_ENV === 'production' \n      ? 'api.therobotoverlord.com' \n      : 'localhost:8000';\n    setWsUrl(`${protocol}//${host}/ws/connect`);\n  }, []);\n\n  const {\n    connected,\n    subscribe,\n    unsubscribe,\n    subscribeToChannel,\n    sendChatMessage,\n    client,\n  } = useWebSocket({\n    url: wsUrl,\n    token,\n    autoConnect: true,\n    onConnect: () => {\n      console.log('WebSocket connected successfully');\n    },\n    onDisconnect: () => {\n      console.log('WebSocket disconnected');\n    },\n  });\n\n  const contextValue: WebSocketContextType = {\n    connected,\n    client,\n    subscribe,\n    unsubscribe,\n    subscribeToChannel,\n    sendChatMessage,\n  };\n\n  if (!wsUrl) {\n    return <>{children}</>;\n  }\n\n  return (\n    <WebSocketContext.Provider value={contextValue}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\nexport function useWebSocketContext() {\n  const context = useContext(WebSocketContext);\n  if (!context) {\n    throw new Error('useWebSocketContext must be used within a WebSocketProvider');\n  }\n  return context;\n}\n"],"mappings":"AAAA;;GAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}